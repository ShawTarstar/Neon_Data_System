<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.taxing.tliaswebmanagement.mapper.oracle.OracleClazzMapper">

    <!-- 插入 -->
    <insert id="insert">
        INSERT INTO "clazz"(
            "name", "room", "begin_date", "end_date",
            "master_id", "subject", "create_time", "update_time"
        ) VALUES (
                     #{name}, #{room}, #{beginDate}, #{endDate},
                     #{masterId}, #{subject}, #{createTime}, #{updateTime}
                 )
    </insert>

    <!-- 修改 -->
    <update id="update">
        UPDATE "clazz"
        SET
            "name" = #{name},
            "room" = #{room},
            "begin_date" = #{beginDate},
            "end_date" = #{endDate},
            "master_id" = #{masterId},
            "subject" = #{subject},
            "update_time" = #{updateTime}
        WHERE "id" = #{id}
    </update>

    <!-- 删除 -->
    <delete id="delete">
        DELETE FROM "clazz"
        WHERE "id" = #{id}
    </delete>

    <!-- 查询列表 -->
    <select id="list" resultType="com.taxing.tliaswebmanagement.pojo.Clazz">
        SELECT
        c."id",
        c."name",
        c."room",
        c."begin_date",
        c."end_date",
        c."master_id",
        e."name" AS "master_name",
        c."create_time",
        c."update_time"
        FROM "clazz" c
        LEFT JOIN "emp" e ON c."master_id" = e."id"
        <where>
            <if test="name != null and name != ''">
                c."name" LIKE '%' || #{name} || '%'
            </if>

            <if test="begin != null and end != null">
                AND c."end_date" BETWEEN #{begin} AND #{end}
            </if>
        </where>
    </select>

    <!-- 通过 ID 查询 -->
    <select id="selectById" resultType="com.taxing.tliaswebmanagement.pojo.Clazz">
        SELECT
            "id", "name", "room", "begin_date", "end_date",
            "master_id", "subject", "create_time", "update_time"
        FROM "clazz"
        WHERE "id" = #{id}
    </select>

    <!-- 班级中学生数量 -->
    <select id="selectInStu" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM "student"
        WHERE "clazz_id" = #{id}
    </select>

    <!-- 查询全部班级 -->
    <select id="selectAllClazzs" resultType="com.taxing.tliaswebmanagement.pojo.Clazz">
        SELECT
            "id", "name", "room", "begin_date", "end_date",
            "master_id", "subject", "create_time", "update_time"
        FROM "clazz"
    </select>

</mapper>
